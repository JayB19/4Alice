<html>
  <head>
    <title>4Alice generator</title>
    <meta charset='utf-8'>
    <link rel="stylesheet" type="text/css" href="style.css"/>
    
    <script>
      window.onload = function(){
        
        function $(id){return document.getElementById(id)}
        
        const VERSION = "0.7.0";
        const TEMPLATE = $('template').innerHTML;
        const MARKERS = [
          //PASTE DATA
          '@MARKER_PRE@',           // 0
          '@MARKER_ALT@',           // 1
          '@MARKER_PROMO@',         // 2
          '@MARKER_UTM@',           // 3
          '@MARKER_PREBTN@',        // 4
          '@MARKER_POSTBTN@',       // 5
          //BANNER IMAGE
          '@MARKER_BANNER@',        // 6
          //SITELIST DATA
          '@MARKER_SITE@',          // 7
          '@MARKER_LOGO@',          // 8
          '@MARKER_PHONE@',         // 9
          '@MARKER_LINK@',          // 10
          //SITELIST COLORS               
          '@MARKER_LOGO_COLOR@',    // 11
          '@MARKER_FOOTER_COLOR@',  // 12
          '@MARKER_BUTTON_COLOR@',  // 13  
          '@MARKER_LOGO_TEXT@',     // 14
          '@MARKER_FOOTER_TEXT@',   // 15
          
        ];
        var CURRENT = -1;
        var BANNER = 0;
        var SWITCH = true;
        var LIST;
        var DATA;
        var BANNERS;

        

        $('b_apply').onclick = function(){
          LIST = parseSiteList();
          DATA = parseData();
          BANNERS = parseBanners();

          addButtons();
        }
        $('b_about').onclick = function(){
          var help_text = ""
                +"v telege skinul kak uzat";
          alert("Template Editor 4Alice v"+VERSION+"\n JayB19 2018");
          $('result').value = help_text;
        }

        function parseSiteList(){
          // returns array of site-data
          // site-data is array too
          var result = $('list').value.split('\n\n');
          for(var i=0; i<result.length; i++){
            result[i] = result[i].split('\n');
          }
          return result;
        }
        
        function parseBanners(){
          // returns array of banner image links
          var result = $('imgs').value.split('\n');
          return result;
        }

        function parseData(){
          // returns array of parse-data
          var result = [];
          result[0] = $('d_pre').value;
          result[1] = $('d_alt').value;
          result[2] = $('d_pro').value;
          result[3] = $('d_utm').value;
          result[4] = $('d_txt1').value;
          result[5] = $('d_txt2').value;
          
          return result;
        }

        function addButtons(){
          var container = $('buttons');
          container.innerHTML = "";
          
          var button;
          //create banner buttons
          for(var i=0; i<BANNERS.length; i++){
            button = document.createElement('button');
            button.name = i;
            button.onclick = clickImg;
            var img = document.createElement('img');
            img.src = BANNERS[i];
            img.style = 'width:100%; height:100%; border-radius: 0px;';
            button.appendChild(img);
            container.appendChild(button);
          }
          
          
          //create site buttons
          for(var i=0; i<LIST.length; i++){
            button = document.createElement('button');
            button.innerHTML = LIST[i][0];
            button.name = i;
            button.onclick = click;
            container.appendChild(button);
          }
        }

        function click(){
          var field = $('result');
          if(CURRENT == +this.name){
            SWITCH = !SWITCH;
          }else{
            SWITCH = true;
          }
          CURRENT = +this.name;
          if(SWITCH){
            field.value = getHtml();
          }else{
            field.value = getPlain();
          }
        }
        
        function clickImg(){
          BANNER = this.name;
        }

        function getPlain(){
          var result = "";
          result += "Hello [[name]]!\n\n"+DATA[4].split('\n').join('').split('<br>').join('\n');
          result += "\n\nGet 16% OFF any order over 5 pages\n\n";
          result += 'https://www.'+LIST[CURRENT][0]+'/order/?numpages=5&promo='+DATA[2]+'&l=[[autohash]]&utm_source=manual&utm_medium=email&utm_campaign='+DATA[3]+LIST[CURRENT][3];
          result += '\n\n' + DATA[5].split('\n').join('').split('<br>').join('\n');
          result += "\n\nBest Regards,\nAlice Fisher\n\n";
          result += "You are receiving this email because you are a registered user of "+drop(LIST[CURRENT][0], ['.com','.co','.uk','.au','.org'])+"."
          
          return result;
        }

        function getHtml(){
          var i;
          var result = TEMPLATE;
          var data = DATA.concat(BANNERS[BANNER]).concat(LIST[CURRENT]);

          console.log(data);
          
          for(i=0; i<data.length; i++){
            result = result.split(MARKERS[i]).join(data[i]);
            console.log(MARKERS[i], data[i]);
          }
          
          //other settings
          
          i = result.lastIndexOf(LIST[CURRENT][0]);
          result = result.substring(0,i) + drop(LIST[CURRENT][0], ['.com','.co','.uk','.au','.org']) + result.substring(i+LIST[CURRENT][0].length);
          
          return result;
        }
        
        function drop(str, list){
            for(var i=0; i<list.length; i++){
              str = str.split(list[i]).join('');
            }
            return str.charAt(0).toUpperCase() + str.slice(1);
          }
      
      }
    </script>
  </head>
  <body>
    <div class='container'>
      <button id='b_about'>About</button>
      <button id='b_apply'>Apply</button>  
      <textarea id='list' rows='6' placeholder='Paste site list here...'></textarea>
      <textarea id='imgs' rows='4' placeholder='Banners'></textarea>
      
      <textarea id='d_pre' rows='2' placeholder='Preheader'></textarea>
      <textarea id='d_alt' rows='2' placeholder='Alt text'></textarea>
      <textarea id='d_pro' rows='2' placeholder='Promo code'></textarea>
      <textarea id='d_utm' rows='2' placeholder='Campaign'></textarea>
      <textarea id='d_txt1' rows='6' placeholder='Pre text'></textarea>
      <textarea id='d_txt2' rows='6' placeholder='Post text'></textarea>
    </div>
  
    <div class='container'>
      <textarea id='result' rows='16' placeholder='Result will here'></textarea>
      <div id='buttons' style='padding:10px'>Paste site list, new data, and press Apply</div>
    </div>

    
    <!-------------->
    <!-- TEMPLATE -->
    <!-------------->    
    <iframe id='template' style='display:none'>

<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title></title>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'/>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'/>
    <meta name='format-detection' content='telephone=no'/>
    
    <style type='text/css'>
      @media all and (max-width: 600px) {
        .block{
          text-align: center !important;
          max-width: 100% !important;
          //display: block !important;
        }
      }
      
      @media all and (max-width: 400px) {
        .minifont{
          font-size: 11px;
          font-weight: 120;
        }
      }
      
    </style>
  </head>
  
  <body style='margin: 0;-webkit-text-size-adjust: 100%;background: #e1e9ed;'>
    <div style='display:none;max-height:0;overflow:hidden;'>
      @MARKER_PRE@                                                                                 <br>
    </div>
    <!--[if (gte mso 9)|(IE)]>
      <table width='600' align='center' style='border-collapse: collapse;' border='0'>
      <tr>
      <td valign='top' width='600' style='padding-left: 0px; padding-right: 0px;'>
    <![endif]-->
  
  <table cellpadding='8' cellspacing='0' lang='x-outer'  border='0' style='border-collapse: collapse; table-layout: fixed; font-family: "Open Sans",sans-serif; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto;' align='center'>
      <tbody>
        <tr>
          <td colspan='4'>
            <center>
            <div><font style='font-size: 12px;color: #1c2837;'>Please add this address to your Contact List to continue receiving emails in your inbox.</font></div>
            </center>
          </td>
        </tr>
      </tbody>
    </table> 
  
    <table cellpadding='0' cellspacing='0' lang='x-outer'  border='0' style='border-collapse: collapse; table-layout: fixed; font-family: "Open Sans",sans-serif; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; -webkit-box-shadow: 0 3px 9px #313d4c; box-shadow: 0 3px 9px #313d4c;' align='center'>
      <tbody>
        
        <!-- LOGO -->
        <tr  bgcolor='@MARKER_LOGO_COLOR@'>
          <td width='180px' colspan='2' style='padding:10px 0px 10px 5px;'>
            <a target='_blank' style='outline: none' href='https://www.@MARKER_SITE@/?l=[[autohash]]&utm_source=manual&utm_medium=email&utm_campaign=@MARKER_UTM@'>
              <img createnew='true'  style='border: none; max-width: 100%; height: auto;' src='@MARKER_LOGO@' alt='@MARKER_SITE@'/>
            </a>
          </td>
          <td align='right' colspan='2' style='padding: 0px 5px 0px 0px;'>
            <a class='minifont' href='tel:@MARKER_PHONE@' style='white-space: nowrap; outline: none; text-decoration: none; color:@MARKER_LOGO_TEXT@; font-family: "Open Sans",sans-serif; font-weight: 60; -webkit-text-size-adjust:none;'>Tel:+@MARKER_PHONE@<br>SUPPORT 24/7</a>
          </td>
        </tr>
        
        <!-- BANNER -->
        <tr>
          <td colspan='4' style='padding: 0px 0px 0px 0px; !important; border: none' bgcolor='#ffffff'> 
            <div style='border: none'>
              <a target='_blank' style='border: none; outline: none;' href='https://www.@MARKER_SITE@/order/?l=[[autohash]]&utm_source=manual&utm_medium=email&utm_campaign=@MARKER_UTM@'>
                <img  src='@MARKER_BANNER@' alt='@MARKER_ALT@' width=650 style='border: none; outline: none; text-decoration: none; -ms-interpolation-mode: bicubic; display: block; width:100%;'/>
              </a>
            </div>
          </td>
        </tr>
        
        <!-- TEXT $ BUTTON -->
        <tr bgcolor='#ffffff'>
          <td colspan='4' style='padding: 0px 12px 0px 12px;'>
            
            <p style='margin: 1em 0; font-size: 16px; line-height: 1.5em; color: #3b3b3b; font-family: "Open Sans", sans-serif;'>
              Hello [[name]]!
            </p>
            
            <p style='font-size: 16px; line-height: 1.5em; color: #3b3b3b; font-family: "Open Sans", sans-serif;text-align: justify;'>        
              @MARKER_PREBTN@      
            </p>
            
            <p style='font-size: 16px; line-height: 1.5em; color: #3b3b3b; font-family: "Open Sans", sans-serif;text-align:center;'>
              Get 16% OFF any order over 5 pages
            </p>
            
            <div style='text-align: center; margin: 30px 0;'>
              <center>
                <b>
                  <a target='_blank' href='https://www.@MARKER_SITE@/order/?numpages=5&promo=@MARKER_PROMO@&l=[[autohash]]&utm_source=manual&utm_medium=email&utm_campaign=@MARKER_UTM@@MARKER_LINK@' style='font-weight:600; font-size: 18px; text-decoration: none; text-transform: uppercase; color: #ffffff;   background: @MARKER_BUTTON_COLOR@; display: inline-block; margin: 0px 0; padding:10px 40px; border-radius:8px; font-family:Tahoma, Arial, sans-serif' target='_self'>
                    Order now
                  </a>
                </b>
              </center> 
            </div>
            
            <p style='margin: 1em 0; font-size: 16px; line-height: 1.5em; color: #3b3b3b; font-family: "Open Sans", sans-serif;text-align: justify;'>     
              @MARKER_POSTBTN@               
            </p>
            
            <p style='color: #3b3b3b; font-family: "Open Sans",sans-serif; font-size:16px; text-align:left;'> 
              Best Regards,<br>Alice Fisher
            </p>
          </td>
        </tr>
        
        <!-- FOOTER -->
        <tr align='center' bgcolor='@MARKER_FOOTER_COLOR@'>
          <td colspan='4'>
            <table width='100%' border='0' style='border-collapse: collapse; table-layout: fixed; font-family: "Open Sans",sans-serif; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto;'>
              <tr bgcolor='@MARKER_FOOTER_COLOR@'>
                <td align='left' style='padding: 0px 20px 0px 20px;' width='45%'>
                  <p class='minifont' style='font-family: "Open Sans",sans-serif; font-weight: 600; color: @MARKER_FOOTER_TEXT@; -webkit-text-size-adjust:none'>We accept:</p>
                  <img createnew='true'  src='https://multimedia.getresponse.com/getresponse-10719303/photos/381942603.png' alt='Payment Methods' style='max-width: 100%; height: auto;'/>
                </td>
                <td align='right' style='padding: 0px 20px 0px 20px;' width='45%'>
                  <p class='minifont' style='font-family: "Open Sans",sans-serif; font-weight: 598; color: @MARKER_FOOTER_TEXT@; -webkit-text-size-adjust:none'>All payments are processed by:</p>
                  <img createnew='true'  src='https://multimedia.getresponse.com/getresponse-10719303/photos/381942703.png' alt='Secure Payment' style='max-width: 100%; height: auto;'/>
                </td>
              </tr>
            </table>
          </td>
          
        </tr>
        
        <!-- AFTERFOOTER -->
        <tr align='center' bgcolor='@MARKER_FOOTER_COLOR@'>
          <td colspan='4'>
            <p style='font-size: 12px; color: @MARKER_FOOTER_TEXT@; font-family: "Open Sans",sans-serif; text-align: center;'>
              You are receiving this email because you are a registered user of @MARKER_SITE@.
            </p>
          </td>
        </tr>
        
      </tbody>
    </table>
    
    <!--[if (gte mso 9)|(IE)]>
      </td>
      </tr>
      </table>
    <![endif]-->
    
  </body>
</html>                                                  

    </iframe>   
    <!-------------->
    <!-- TEMPLATE -->
    <!-------------->
  
  </body>
</html>
